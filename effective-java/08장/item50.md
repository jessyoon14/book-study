# 50. ì ì‹œì— ë°©ì–´ì  ë³µì‚¬ë³¸ì„ ë§Œë“¤ë¼

ìë°”ëŠ” ì•ˆì „í•œ ì–¸ì–´ë‹¤

- ë„¤ì´í‹°ë¸Œ ë©”ì„œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì•„ì„œ C/C++ì—ì„œ ë°œìƒí•˜ëŠ” buffer overrun, array overrun, wild pointer ë“± ë©”ëª¨ë¦¬ ì¶©ëŒ ì˜¤ë¥˜ê°€ ë°œìƒí•˜ì§€ ì•ŠëŠ”ë‹¤

ê·¸ëŸ¬ë‚˜ í´ë˜ìŠ¤ì˜ ì¹¨ë²”ì€ ë§‰ì•„ì•¼ í•œë‹¤!

<aside>
ğŸ’¡ í´ë¼ì´ì–¸íŠ¸ê°€ í´ë˜ìŠ¤ ë¶ˆë³€ì‹ì„ ê¹¨ëœ¨ë¦¬ë ¤ê³  ë…¸ë ¥í•œë‹¤ê³  ê°€ì •í•˜ê³  ë°©ì–´ì ìœ¼ë¡œ í”„ë¡œê·¸ë˜ë°í•´ë¼!

</aside>

### ê°ì²´ ìˆ˜ì •

- ê°ì²´ì˜ í—ˆë½ ì—†ì´ëŠ” ì™¸ë¶€ì—ì„œ ë‚´ë¶€ë¥¼ ìˆ˜ì •í•  ìˆ˜ ì—†ì–´ì•¼ í•œë‹¤
    - ì£¼ì˜: ê°€ë³€ ê°ì²´ ì°¸ì¡°ë¥¼ finalë¡œ ì„ ì–¸í•´ë„, ì°¸ì¡°ëœ ê°ì²´ë¥¼ ë°”ê¿€ ìˆ˜ ìˆë‹¤! â†’ ì´ ëª©ì ì´ë¼ë©´ ë¶ˆë³€ ê°ì²´ë¥¼ ì¨ë¼!
        
        ```java
        public final class Period {
        	private final Date start;
        	private final Date end;
        }
        
        Date start = new Date();
        Date end = new Date();
        Period p = new Period(start, end);
        start.setYear(2022); // ê°ì²´ê°€ ë³€ê²½ë¨!!!!
        ```
        
        - ìë°” 8ë¶€í„° immutableí•œ Instant, LocalDateTime, ZonedDateTime ì‚¬ìš©í•˜ë©´ ëœë‹¤
        - ê°€ë³€ì¸ DateëŠ” ë‚¡ì•˜ìœ¼ë‹ˆ ë”ì´ìƒ ì‚¬ìš©í•˜ì§€ ë§ë¼

### ë°©ì–´ì  ë³µì‚¬

```java
// ìƒì„±ì
public Period(Date start, Date end) {
	this.start = new Date(start.getTime());
	this.end = new Date(end.getTime());
	... // start < endì¸ ê²ƒ í™•ì¸
}

// ì ‘ê·¼ì
public Date start() {
	return new Date(start.getTime());
}
```

- ê°ì²´ ë‚´ë¶€ë¥¼ ì™¸ë¶€ ê³µê²©ìœ¼ë¡œë¶€í„° ë³´í˜¸í•˜ë ¤ë©´ ìƒì„±ìê°€ ë°›ì€ ê°€ë³€ ë§¤ê°œë³€ìˆ˜ë¥¼ ëª¨ë‘ defensive copyí•´ì•¼ í•œë‹¤ (ì¸ìŠ¤í„´ìŠ¤ ë‚´ë¶€ì—ì„œëŠ” ì „ë¶€ ë³µì‚¬ë³¸ ì‚¬ìš©)
- ë°˜ë“œì‹œ ë°©ì–´ì  ë³µì‚¬ë³¸ì„ ë¨¼ì € ë§Œë“  í›„ì— ë§¤ê°œë³€ìˆ˜ ìœ íš¨ì„± ê²€ì‚¬ë¥¼ í•´ì•¼í•œë‹¤ (multithreading ê²½ìš° ëŒ€ë¹„)
    - TOCTOU (Time of check / Time of use ê³µê²©)
- ë§¤ê°œë³€ìˆ˜ê°€ ì œ 3ìì— ì˜í•´ í™•ì¥ë  ìˆ˜ ìˆëŠ” íƒ€ì…ì´ë¼ë©´ ë°©ì–´ì  ë³µì‚¬ë³¸ì„ ë§Œë“¤ë•Œ clone()ì„ ì‚¬ìš©í•˜ì§€ ë§ë¼
    - Date.clone()ë§ê³  ìƒˆë¡œ Dateë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤
    - input ê°ì²´ê°€ Dateì˜ ì•…ì˜ì  í•˜ìœ„ í´ë˜ìŠ¤ì¼ ìˆ˜ë„ ìˆë‹¤
- ì ‘ê·¼ìì—ì„œë„ ë‚´ë¶€ ê°ì²´(ê°€ë³€ í•„ë“œ)ë¥¼ ê·¸ëŒ€ë¡œ ë¦¬í„´í•˜ì§€ ë§ê³  ì˜ ë°©ì–´ì  ë³µì‚¬ë³¸ì„ ë°˜í™˜
    - ì ‘ê·¼ìì—ì„œëŠ” cloneìœ¼ë¡œ ë°©ì–´ì  ë³µì‚¬ë¥¼ í•´ë„ ë˜ì§€ë§Œ, ì¼ë°˜ì ìœ¼ë¡œ ìƒì„±ìë‚˜ ì •ì  íŒ©í„°ë¦¬ë¥¼ ì“°ëŠ”ê²Œ ì¢‹ë‹¤
    - ë‚´ë¶€ì—ì„œ ì‚¬ìš©í•˜ëŠ” ë°°ì—´ì„ í´ë¼ì´ì–¸íŠ¸ì— ë°˜í™˜í•  ë•ŒëŠ” í•­ìƒ ë°©ì–´ì  ë³µì‚¬!
- ì´ë ‡ê²Œ ì„¸ê°€ì§€ë¥¼ ì§€í‚¤ë©´ ì™„ë²½í•œ ë¶ˆë³€ í´ë˜ìŠ¤ê°€ ë˜ì–´ ì•…ì˜ì ì¸ ì‚¬ìš©ìë„ ì ˆëŒ€ ë¶ˆë³€ì‹ (start < end)ì„ ê¹¨ëŠ” ê°ì²´ë¥¼ ë§Œë“¤ ìˆ˜ ì—†ë‹¤
- ê·¸ì™¸
    - í´ë¼ì´ì–¸íŠ¸ê°€ ì œê³µí•œ ê°ì²´ë¥¼ ë‚´ë¶€ ìë£Œêµ¬ì¡°ì— ë³´ê´€í•´ì•¼ í•  ë•Œ, ê·¸ ê°ì²´ê°€ ë‚˜ì¤‘ì— ë³€ê²½ë˜ëŠ” ê²ƒê¹Œì§€ ê³ ë ¤í•´ì„œ ë°©ì–´ì  ë³µì‚¬ë¥¼ í• ì§€ ê³ ë¯¼ (ë¬¸ì œê°€ ìƒê¸¸ ìˆ˜ ìˆë‹¤ë©´ ë°©ì–´ì  ë³µì‚¬í•´ì•¼í•¨)
        - ì˜ˆì‹œ) í´ë¼ì´ì–¸íŠ¸ê°€ ì¤€ ê°ì²´ë¥¼ Mapì˜ keyë¡œ ì‚¬ìš©í•  ê²½ìš°

â†’ ë˜ë„ë¡ ë¶ˆë³€ ê°ì²´ë“¤ì„ ì¡°í•©í•´ ê°ì²´ë¥¼ êµ¬ì„±í•´ì•¼ ë°©ì–´ì  ë³µì‚¬ë¥¼ í•  ì¼ì´ ì¤„ì–´ë“ ë‹¤

(Dateë§ê³  Instant ì‚¬ìš©!)

### ìƒëµ ê°€ëŠ¥í•  ë•Œ

ë°©ì–´ì  ë³µì‚¬ëŠ” ì„±ëŠ¥ì„ ì €í•˜í•œë‹¤

- í´ë¼ì´ì–¸íŠ¸ë¥¼ ì‹ ë¢°í•  ìˆ˜ ìˆì„ ë•Œ
    - í˜¸ì¶œìê°€ ê°ì²´ ë‚´ë¶€ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šì„ ê²ƒì´ë¼ í™•ì‹ í•  ìˆ˜ ìˆì„ ë•Œ (ex. ê°™ì€ íŒ¨í‚¤ì§€ ë‚´ë¶€)
- ë¶ˆë³€ì‹ì´ ê¹¨ì ¸ë„ ì˜í–¥ì´ í˜¸ì¶œí•œ í´ë¼ì´ì–¸íŠ¸ë¡œ êµ­í•œë  ë•Œ (ê¹¨ì ¸ë„ í´ë¼ì´ì–¸íŠ¸ì˜ ì±…ì„)
    - í´ë¼ì´ì–¸íŠ¸ê°€ ê°€ë³€ ê°ì²´ì˜ í†µì œê¶Œì„ ë„˜ê²¨ì¤„ ë•Œ â†’ í˜¸ì¶œìë¥¼ ë¯¿ì–´ì•¼í•˜ë¯€ë¡œ ê³µê²©ì— ì·¨ì•½í•˜ë‹¤ (ì´ë˜ì„œ ëŸ¬ìŠ¤íŠ¸ë¥¼ ì“°ëŠ”êµ°)
    

### ê³ ë¯¼

ë³´ì•ˆì„ ìƒê°í•˜ë©´ì„œ ì½”ë”©í•˜ëŠ” ê²ƒì€ ì •ë§ ì •ë§ ì–´ë ¤ìš´ ì¼ì´ì—ˆì–´.

ê·¼ë° ì´ê±´ ë‹¤ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì œê³µí•  ë•Œ ì‹ ê²½ ì¨ì•¼í•˜ëŠ” ê²ƒì´ì§€, ì¼ë°˜ì ì¸ ë°±ì—”ë“œë¥¼ ì§¤ ë•ŒëŠ” ë¶ˆë³€ ê°ì²´ë¥¼ ë§Œë“¤ì¼ì´ ê·¸ë ‡ê²Œ ë§ì§€ ì•Šì€ ê²ƒ ê°™ì•„ì„œ, ë°©ì–´ì  ë³µì‚¬ë¥¼ ë³„ë¡œ ì‚¬ìš©í•˜ì§€ ì•Šì„ ê²ƒ ê°™ë‹¤. ë¬´ì¡°ê±´ ë¶ˆë³€ì´ì–´ì•¼ í•  ë•Œë§Œ ì“¸í…ë°, ì´ë•Œë„ ì½”ë“œì˜ ëª…í™•í•˜ë„ë¡ namingì— ì‹ ê²½ì„ ë§ì´ ì¨ì•¼í•  ê²ƒ ê°™ë‹¤. ì˜¤íˆë ¤ ë°©ì–´ì  ë³µì‚¬ë¥¼ ì“´ë‹¤ëŠ” ì‚¬ì‹¤ì„ ìŠìœ¼ë©´ ë‚˜ëŠ” ì´ ê°ì²´ë¥¼ ë³€ê²½í•œë‹¤ê³  ìƒê°í•˜ëŠ”ë° ë³€ê²½ì´ ì•ˆë˜ëŠ” ë¬¸ì œê°€ ì¼ì–´ë‚˜ë‹ˆê¹Œ.

ì§€ê¸ˆê¹Œì§€ deprecatedëœ ê²ƒë„ ë¬´ì‹œí•˜ê³  ë‹¤ ì¼ëŠ”ë°, ë‹¤ ì´ìœ ê°€ ìˆì–´ì„œ deprecateëœê±°ë‹ˆê¹Œ ì´ì œ ì“°ë©´ ì•ˆë˜ê² ë‹¤.

ë¼ì´ë¸ŒëŸ¬ë¦¬: í´ë¼ë¦¬ì–¸íŠ¸ë¥¼ ì ˆëŒ€ ë¯¿ì§€ ë§ë¼

ëŒ€í•™ìƒ í”„ë¡œì íŠ¸ ìˆ˜ì¤€ì˜ ë°±ì—”ë“œ: ë©”ì„œë“œ í˜¸ì¶œìì—ê²Œ ë§ì€ ê²ƒì„ ê¸°ëŒ€í•˜ë©° ë©”ì„œë“œë¥¼ ê¸°ë³¸ êµ¬í˜„ë§Œ í•˜ë„ë¡ ì‘ì„± 

ê·¼ë° ê¸°ì—… ìˆ˜ì¤€ì˜ ë°±ì—”ë“œì—ì„œëŠ” ì´ ë‘ê°€ì§€ë¥¼ ìƒì¶©í•´ì•¼ í•œë‹¤ (ë‚¨ì´ ì´ ë©”ì„œë“œë¥¼ ì˜ëª» ì“¸ ìˆ˜ ìˆìœ¼ë‹ˆ ë§ì€ ê²€ì¦ê³¼ ë°©ì–´ì  ë³µì‚¬ë¥¼ í•˜ë˜, ëˆ„êµ°ê°€ ì•…ì˜ë¥¼ ê°€ì§€ê³  ì“¸ ê²ƒì€ ì•„ë‹ˆë‹ˆ ì ë‹¹ì´ íš¨ìœ¨ì ìœ¼ë¡œ)